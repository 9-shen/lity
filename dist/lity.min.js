/*! Lity - v2.0.0 - 2016-08-02
* http://sorgalla.com/lity/
* Copyright (c) 2015-2016 Jan Sorgalla; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(a,c)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a,require("jquery")):a.lity=b(a,a.jQuery||a.Zepto)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(a){var b=v();return E&&a.length?(a.one(E,b.resolve),setTimeout(b.resolve,500)):b.resolve(),b.promise()}function d(a,c,d){if(1===arguments.length)return b.extend({},a);if("string"==typeof c){if("undefined"==typeof d)return"undefined"==typeof a[c]?null:a[c];a[c]=d}else b.extend(a,c);return this}function e(a){for(var b,c=decodeURI(a).split("&"),d={},e=0,f=c.length;e<f;e++)c[e]&&(b=c[e].split("="),d[b[0]]=b[1]);return d}function f(a,c){return a+(a.indexOf("?")>-1?"&":"?")+b.param(c)}function g(a){return b('<span class="lity-error"/>').append(a)}function h(a){if(!A.test(a))return!1;var c=b('<img src="'+a+'"/>'),d=v(),e=function(){d.reject(g("Failed loading image"))};return c.on("load",function(){return 0===this.naturalWidth?e():void d.resolve(c)}).on("error",e),d.promise()}function i(a,c){var d,e,f;try{d=b(a)}catch(g){return!1}return!!d.length&&(e=b('<i style="display:none !important"/>'),f=d.hasClass("lity-hide"),c.element().one("lity:remove",function(){e.before(d).remove(),f&&!d.closest(".lity-content").length&&d.addClass("lity-hide")}),d.removeClass("lity-hide").after(e))}function j(a){var c,d=a;return c=B.exec(a),c&&(d=f("https://www.youtube"+(c[2]||"")+".com/embed/"+c[4],b.extend({autoplay:1},e(c[5]||"")))),c=C.exec(a),c&&(d=f("https://player.vimeo.com/video/"+c[3],b.extend({autoplay:1},e(c[4]||"")))),c=D.exec(a),c&&(d=f("https://www.google."+c[3]+"/maps?"+c[6],{output:c[6].indexOf("layer=c")>0?"svembed":"embed"})),'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+d+'"/></div>'}function k(){return t.documentElement.clientHeight?t.documentElement.clientHeight:Math.round(u.height())}function l(a){var b=p();b&&27===a.keyCode&&b.options("esc")&&(a.preventDefault(),b.close())}function m(){var a=k();b.each(x,function(b,c){c.resize(a)})}function n(a){1===x.unshift(a)&&(w.addClass("lity-active"),u.on({resize:m,keydown:l}))}function o(a){1===x.length&&(w.removeClass("lity-active"),u.off({resize:m,keydown:l})),x=b.grep(x,function(b){return a!==b})}function p(){return 0===x.length?null:x[0]}function q(a,c,d,e){var f,g="inline",h=b.extend({},d);return e&&h[e]?(f=h[e](a,c),g=e):(b.each(["inline","iframe"],function(a,b){delete h[b],h[b]=d[b]}),b.each(h,function(b,d){return!d||(f=d(a,c),!1!==f?(g=b,!1):void 0)})),{handler:g,content:f||""}}function r(a,e,f,g){function h(a){l=b(a).css("max-height",k()+"px"),j.find(".lity-loader").each(function(){var a=b(this);c(a).always(function(){a.remove()})}),j.removeClass("lity-loading").find(".lity-content").empty().append(l),l.find(y).first().focus(),p=!0,l.trigger("lity:ready",[m])}var i,j,l,m=this,p=!1,r=!1;e=b.extend({},z,e),j=b(e.template),m.element=function(){return j},m.opener=function(){return f},m.options=b.proxy(d,m,e),m.handlers=b.proxy(d,m,e.handlers),m.resize=function(a){p&&!r&&l.css("max-height",(a||k())+"px").trigger("lity:resize",[m])},m.close=function(){if(p&&!r){r=!0,o(m);var a=v();return g&&b.contains(j,t.activeElement)&&g.focus(),l.trigger("lity:close",[m]),j.removeClass("lity-opened").addClass("lity-closed"),c(l.add(j)).always(function(){l.trigger("lity:remove",[m]),j.remove(),j=void 0,a.resolve()}),a.promise()}},i=q(a,m,e.handlers,e.handler),j.addClass("lity-loading lity-opened lity-"+i.handler).appendTo("body").focus().on("click","[data-lity-close]",function(a){b(a.target).is("[data-lity-close]")&&m.close()}).trigger("lity:open",[m]),n(m),b.when(i.content).always(h)}function s(a,c,d){a.preventDefault?(a.preventDefault(),d=b(this),a=d.data("lity-target")||d.attr("href")||d.attr("src")):d=b(d);var e=new r(a,b.extend({},d.data("lity-options")||d.data("lity"),c),d,t.activeElement);if(!a.preventDefault)return e}var t=a.document,u=b(a),v=b.Deferred,w=b("html"),x=[],y='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',z={handler:null,handlers:{image:h,inline:i,iframe:j},esc:!0,template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},A=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,B=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i,C=/(vimeo(pro)?.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/,D=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i,E=function(){var a=t.createElement("div"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return b[c];return!1}();return s.version="2.0.0",s.options=b.proxy(d,s,z),s.handlers=b.proxy(d,s,z.handlers),s.current=p,b(t).on("click","[data-lity]",s),s});